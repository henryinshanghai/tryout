package com.henry.tryout.leetcodes.Huawei.phase2.str.repeated_string_match_686.exe.KMP;

// è®¡ç®—LPSæ•°ç»„ï¼ˆå·²åŒ¹é…å­ä¸²çš„ æœ€é•¿å…¬å…±å‰åç¼€ çš„é•¿åº¦ï¼‰
// æ¨èä½¿ç”¨ 0-based çš„ LPSï¼ˆLongest Prefix Suffixï¼‰æ•°ç»„ï¼Œé¿å… äººä¸ºæ·»åŠ  å ä½ç¬¦
// æ¦‚å¿µï¼šâ‘  å­ä¸²å­—ç¬¦æŒ‡é’ˆï¼›â‘¡ å‰ç¼€æŒ‡é’ˆï¼ˆç»“æŸä½ç½®çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼‰ï¼›
// â‘¢ æ‰©å±•å‰åç¼€ï¼›â‘£ å›é€€å‰ç¼€æŒ‡é’ˆï¼ˆæ¥ç»§ç»­å°è¯•æ‰©å±•ï¼‰
// ğŸ– å®šä¹‰çš„å‰ç¼€æŒ‡é’ˆ æŒ‡å‘çš„æ˜¯ å½“å‰å­ä¸²çš„æœ€é•¿å…¬å…±å‰åç¼€çš„å‰ç¼€ç»“æŸä½ç½®çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œæ°å¥½ ç­‰äº å‰ç¼€é•¿åº¦
public class ConstructLPS {

    /**
     * è®¡ç®— ç»™å®šçš„æ¨¡å¼å­—ç¬¦ä¸² çš„æœ€é•¿å…¬å…±å‰åç¼€çš„é•¿åº¦
     *
     * @param pattern æ¨¡å¼å­—ç¬¦ä¸²ï¼ˆæ ‡å‡† 0-based å­—ç¬¦ä¸²ï¼‰
     * @return æ¨¡å¼å­—ç¬¦ä¸²åœ¨å„ä¸ªä½ç½®ä¸Šçš„å‰ç¼€ä½ç½®æ•°ç»„
     */
    public int[] computeLPS(String pattern) {
        int patCharAmount = pattern.length();
        int[] currentSpotToItsPrefixLength = new int[patCharAmount]; // lps[i] = pattern[0..i] çš„æœ€é•¿å…¬å…±çœŸå‰åç¼€é•¿åº¦

        /* ğŸ– å‰ç¼€å­—ç¬¦åºåˆ—æœ«å°¾å­—ç¬¦çš„ä¸‹ä¸€ä¸ªä½ç½®æŒ‡é’ˆ currentPrefixEndNextSpot ä¸
            å‰ç¼€é•¿åº¦prefixLengthçš„å…³ç³»æ˜¯ï¼šcurrentPrefixEndNextSpot = prefixLength */
        // å‡†å¤‡ â€˜æœ€é•¿å…¬å…±å‰åç¼€â€™çš„å‰ç¼€ç»“æŸæŒ‡é’ˆï¼ˆç”¨äºæŒ‡å‘ å‰ç¼€å­—ç¬¦åºåˆ—çš„æœ«å°¾å­—ç¬¦çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼‰
        // åˆå§‹ æŒ‡åœ¨ä½ç½®0ï¼Œè¡¨ç¤º è¿˜æ²¡æœ‰å…¬å…±å‰åç¼€
        int currentPrefixEndNextSpot = 0;

        // å‡†å¤‡ å­ä¸²çš„å­—ç¬¦ç»“æŸæŒ‡é’ˆï¼ˆç”¨äºæŒ‡å‘ å½“å‰å­ä¸²çš„ç»“æŸä½ç½®ï¼‰
        // åˆå§‹æŒ‡åœ¨ä½ç½®1ï¼Œå› ä¸ºæŒ‰ç…§å®šä¹‰ å•ä¸€å­—ç¬¦ ä¸å­˜åœ¨æœ€é•¿å…¬å…±å‰åç¼€ï¼ˆLPS(0)=0ï¼‰
        int currentSubStrEndCursor = 1;

        while (currentSubStrEndCursor < patCharAmount) {
            /* å°è¯•æ‰©å±• å…¬å…±å‰åç¼€ */
            // å¦‚æœ æ–°å¢çš„å­ä¸²å­—ç¬¦ ä¸ å½“å‰å‰ç¼€æŒ‡é’ˆ æ‰€æŒ‡å‘çš„å­—ç¬¦ ç›¸åŒï¼Œ
            // è¯´æ˜ èƒ½å¤Ÿæ‰©å±•â€˜å…¬å…±å‰åç¼€â€™ï¼Œåˆ™ï¼š
            if (pattern.charAt(currentSubStrEndCursor) ==
                    pattern.charAt(currentPrefixEndNextSpot)) {
                // â‘  æŠŠ å‰ç¼€æŒ‡é’ˆ å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼ˆæ‰©å±• å…¬å…±å‰åç¼€ï¼‰
                currentPrefixEndNextSpot++;
                // â‘¡ æ·»åŠ  å½“å‰å­ä¸²pat[0..i] -> å…¶æœ€é•¿å…¬å…±å‰åç¼€çš„å‰ç¼€é•¿åº¦ çš„æ˜ å°„
                // ğŸ– å‰ç¼€é•¿åº¦ prefixLength == å‰ç¼€æŒ‡é’ˆprefixEndNextSpotçš„ä½ç½®
                currentSpotToItsPrefixLength[currentSubStrEndCursor] = currentPrefixEndNextSpot;
                // â‘¢ æŠŠ å­ä¸²å­—ç¬¦æŒ‡é’ˆ ä¹Ÿå‘åç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼ˆç»§ç»­æ£€æŸ¥ä¸‹ä¸€ä¸ª è¢«æ‰©å±•çš„æ¨¡å¼å­—ç¬¦ï¼‰
                currentSubStrEndCursor++;
            } else { // å¦åˆ™ï¼Œè¯´æ˜ å…¬å…±å‰åç¼€ æ‰©å±•å¤±è´¥ï¼Œåˆ™ï¼š
                /* ï¼ˆæ ¹æ®æ—¢æœ‰çš„LPS[]æ•°ç»„çš„æŒ‡å¯¼ï¼‰å›é€€â€˜å‰ç¼€æŒ‡é’ˆâ€™ æ¥ å°è¯•æ‰¾åˆ° æ›´çŸ­çš„å…¬å…±å‰åç¼€ */
                // â‘  å¦‚æœ å½“å‰å‰ç¼€æŒ‡é’ˆçš„ä½ç½® è¿˜ä¸æ˜¯ 0ï¼Œè¯´æ˜ è¿˜æœ‰å›é€€ç©ºé—´ï¼Œåˆ™ï¼š
                if (currentPrefixEndNextSpot != 0) {
                    // ï¼ˆåˆ©ç”¨å·²è®¡ç®—çš„ lpsä¿¡æ¯ï¼‰å›é€€ å‰ç¼€æŒ‡é’ˆ
                    // æ‰‹æ®µï¼šå›é€€åˆ° lps[len-1]ä½ç½®å¤„
                    // åŸç†ï¼šâ€˜æ›´çŸ­çš„å…¬å…±å‰åç¼€çš„kâ€™ æ°å¥½æ˜¯ pat[0..len-1]çš„æœ€é•¿å…¬å…±å‰åç¼€ï¼ˆé€»è¾‘è¯æ˜ï¼‰
                    // è¯¦è§ construct_LPS_05
                    currentPrefixEndNextSpot = currentSpotToItsPrefixLength[currentPrefixEndNextSpot - 1];
                } else { // â‘¡ å¦‚æœ å½“å‰å‰ç¼€æŒ‡é’ˆçš„ä½ç½® ä¸º 0ï¼Œè¯´æ˜ æ²¡èƒ½æ‰¾åˆ°â€˜æ›´çŸ­çš„å…¬å…±å‰åç¼€â€™ï¼Œåˆ™ï¼š
                    // æŠŠ å½“å‰å­ä¸²pat[0..1] çš„ æœ€é•¿å…¬å…±å‰åç¼€çš„å‰ç¼€é•¿åº¦  å½’é›¶
                    currentSpotToItsPrefixLength[currentSubStrEndCursor] = 0;
                    // æŠŠ å­ä¸²å­—ç¬¦æŒ‡é’ˆ å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼ˆç»§ç»­æ£€æŸ¥ä¸‹ä¸€ä¸ª è¢«æ‰©å±•çš„æ¨¡å¼å­—ç¬¦ï¼‰
                    currentSubStrEndCursor++;
                }
            }
        }

        // è¿”å› è®¡ç®—å¾—åˆ°çš„ å½“å‰å­ä¸²(å­—ç¬¦æŒ‡é’ˆä½ç½®) -> å…¶æœ€é•¿å‰åç¼€é•¿åº¦(å‰ç¼€æŒ‡é’ˆä½ç½®) çš„æ•°ç»„
        // ä¹Ÿå°±æ˜¯ å¤§åé¼é¼çš„LPS[]æ•°ç»„ï¼ˆKMPç®—æ³•çš„å…³é”®ï¼‰
        return currentSpotToItsPrefixLength;
    }
}
