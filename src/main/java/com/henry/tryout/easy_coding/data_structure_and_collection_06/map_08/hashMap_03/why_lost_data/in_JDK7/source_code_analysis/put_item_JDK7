public V put(K key, V value) {
    int hash = hash(key);
    int i = indexFor(hash, table.length);

    // æ‰¾åˆ° æ•°ç»„å¯¹åº”ä¸‹æ ‡çš„ä½ç½® - æ‰‹æ®µï¼šä½¿ç”¨hashCode
    // æ˜¯è¦ è¦†ç›–æ—§çš„å…ƒç´  è¿˜æ˜¯ æ·»åŠ æ–°çš„å…ƒç´ 
    // æ‰‹æ®µï¼šæ ¹æ® equals()æ–¹æ³• æ‰€è¿”å›çš„ booleanç±»å‹ç»“æœ
    for(Entry<K, V> e = table[i]; e != null; e = e.next) {
        // å¦‚æœ keyçš„hash æ˜¯ ç›¸åŒçš„ï¼Œåˆ™ï¼š
        // åˆ¤æ–­key æ˜¯ä¸æ˜¯ ç›¸åŒçš„key - æ‰‹æ®µï¼šç­‰å€¼åˆ¤æ–­ æˆ–è€… equals()åˆ¤æ–­ï¼›
        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {
            V oldValue = e.value;
            e.value = value;
            return oldValue;
        }
    }

    // è¿˜æ²¡æœ‰ æ·»åŠ å…ƒç´  å°±è¿›è¡Œ modCount++ ğŸ– è¿™ä¼šå¯¼è‡´å¾ˆå¤šçš„éšæ‚£
    modCount++;

    // æ·»åŠ æ–°çš„å…ƒç´  - æœ€åä¸€ä¸ªå‚æ•°iæ˜¯ tableæ•°ç»„çš„ä¸‹æ ‡
    addEntry(hash, key, value, i);
    return null;
}

void addEntry(int hash, K key, V value, int bucketIndex) {
    // å¦‚æœï¼šâ‘  å…ƒç´ çš„ä¸ªæ•° è¾¾åˆ° thresholdçš„æ‰©å®¹é˜ˆå€¼; â‘¡ æ•°ç»„ä¸‹æ ‡ä½ç½®ä¸Š å·²ç»å­˜åœ¨æœ‰ å…ƒç´ ã€‚åˆ™ï¼šè¿›è¡Œæ‰©å®¹
    if((size > threshold) && (null != table[bucketIndex]) {
        // æŠŠ å®¹é‡ æ‰©å¤§ä¸º å…ˆå‰çš„ä¸¤å€  - size æ˜¯ å…ƒç´ çš„æ•°é‡, table.length ä¸º æ•°ç»„çš„å®¹é‡
        resize(table.length * 2)
        hash = (null != key) ? hash(key) : 0;
        bucketIndex = indexFor(hash, table.length);
    }

    createEntry(hash, key, value, bucketIndex);
}

// æ’å…¥å…ƒç´  - å¤´æ’æ³•
void createEntry(int hash, K key, V value, int bucketIndex) {
    // è®°å½•ä¸‹ å½“å‰å“ˆå¸Œæ§½ä¸Š çš„Entryå…ƒç´ 
    Entry<K, V> e = table[bucketIndex]; // #1
    // åˆ›å»º ä¸€ä¸ªæ–°çš„EntryèŠ‚ç‚¹ æ”¾åˆ° å“ˆå¸Œæ§½ä¸­ï¼Œå¹¶ æŠŠ æ—§çš„EntryèŠ‚ç‚¹ æ¥åˆ° æ–°èŠ‚ç‚¹çš„åé¢
    table[bucketIndex] = new Entry<>(hash, key, value, e);
    size++;
}

å¤šçº¿ç¨‹ä¸‹ï¼ŒJDK7ä¸­ å¯¹put()æ–¹æ³•çš„å®ç° å¯èƒ½ä¼šæœ‰ å¦‚ä¸‹é—®é¢˜ï¼š
æ—¶é—´é¡ºåºä¸‹ï¼š
step1 çº¿ç¨‹A æ‰§è¡Œåˆ°#1æ—¶ï¼Œç”±äº CPUæ—¶é—´ç‰‡ç»“æŸ è€Œ è¢«æŒ‚èµ·;
step2 çº¿ç¨‹B è·å–åˆ° CPUæ—¶é—´ç‰‡ï¼Œå¹¶ é¡ºåˆ©æ‰§è¡Œäº† æ•´ä¸ªcreateEntry()æ–¹æ³• - è¿™æ—¶ æ–°çš„entry å·²ç» è¢«æ·»åŠ å®Œæˆ
step3 çº¿ç¨‹A é‡æ–°è·å–åˆ° æ—¶é—´ç‰‡ï¼Œä¼šç»§ç»­ ä»#1å¤„å¼€å§‹æ‰§è¡Œ - è¿™å°±ä¼šå¯¼è‡´ çº¿ç¨‹Bæ‰€æ·»åŠ çš„æ–°entry è¢«è¦†ç›–æ‰
