--- org.springframework.web.servlet.HandlerMapping.getHandler() ---
ä½œç”¨ï¼šä¸ºå½“å‰è¯·æ±‚ è¿”å› ä¸€ä¸ªhandler ä¸ ä»»æ„æ•°é‡çš„æ‹¦æˆªå™¨ã€‚
ç‰¹å¾ï¼š
    #1 å¯ä»¥æ ¹æ® è¯·æ±‚URLã€ä¼šè¯çŠ¶æ€ æˆ–è€… å®ç°ç±»æ‰€é€‰æ‹©çš„å…¶ä»–å› ç´  æ¥ åšå‡ºé€‰æ‹©?
    #2 è¿”å›çš„ HandlerExecutionChain åŒ…å«æœ‰ä¸€ä¸ª handlerå¯¹è±¡ï¼ˆè€Œä¸æ˜¯æŸç§ tagå½¢å¼çš„æ¥å£ï¼‰- è¿™æ · handlerså°±ä¸ä¼šå—åˆ°ä»»ä½•åœ°çº¦æŸã€‚
        ä»€ä¹ˆå«åš â€œä¸å—çº¦æŸâ€ï¼Ÿ
            ä¾‹å¦‚è¯´ï¼Œä¸€ä¸ª HandlerAdapter å°±å¯ä»¥è¢«é‡å†™ æ¥ å…è®¸å…¶ä»–æ¡†æ¶çš„handlerå¯¹è±¡è¢«ä½¿ç”¨ã€‚
    #3 å¦‚æœæ²¡æœ‰ä»»ä½•åŒ¹é…ç»“æœï¼Œåˆ™ï¼šè¿”å›null - è¿™ä¸æ˜¯ä¸€ä¸ªerrorã€‚
        ä¸ºä»€ä¹ˆè¿”å›null ä¸æ˜¯ä¸€ä¸ªerrorï¼Ÿ
        å› ä¸º DispatcherServlet ä¼šæŸ¥è¯¢ â€œæ‰€æœ‰æ³¨å†Œçš„HandlerMapping Beansâ€ æ¥ è¯•å›¾æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…ç»“æœï¼Œ
        å¹¶ä¸”åªä¼šåœ¨æ‰¾ä¸åˆ°handlerçš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šå†³å®š â€œæœ‰ä¸€ä¸ªerrorâ€ã€‚
å‚æ•°ï¼š
    request - å½“å‰çš„HTTPè¯·æ±‚
è¿”å›å€¼ï¼š
    ä¸€ä¸ª HandlerExecutionChainå®ä¾‹ï¼Œå…¶ä¸­åŒ…å« handlerå¯¹è±¡ ä¸ ä»»æ„æ•°é‡çš„æ‹¦æˆªå™¨ï¼Œæˆ–è€… null(å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•mapping)

ä¹¦æœ¬ï¼š
    getHandler()æ–¹æ³• æ˜¯ å®é™…ä½¿ç”¨HandlerMapping æ¥ å®Œæˆè¯·æ±‚çš„æ˜ å°„å¤„ç† çš„åœ°æ–¹ã€‚

factï¼šæ‰§è¡Œ HandlerExecutionChainæ—¶ï¼Œä¼šé¦–å…ˆ åœ¨AbstractHandlerMappingä¸­ï¼Œè°ƒç”¨getHandler()æ–¹æ³•ã€‚
-- org.springframework.web.servlet.handler.AbstractHandlerMapping.getHandler --
ä½œç”¨ï¼šä¸ºæŒ‡å®šçš„request æ‰¾åˆ°ä¸€ä¸ªhandlerï¼›
ç‰¹å¾ï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¸“é—¨çš„handlerï¼Œåˆ™ ä¼šä½¿ç”¨é»˜è®¤çš„handlerï¼›

å…³é”®ä»£ç è§£é‡Šï¼š
public final HandlerExecutionChain getHandler(HttpServletRequest request) {

    // ä½¿ç”¨ é»˜è®¤çš„handlerï¼Œä¹Ÿå°±æ˜¯ /æ‰€å¯¹åº”çš„handler
    if (handler == null) {
        handler = getDefaultHandler();
    }
    ...
    // é€šè¿‡åç§° æ¥ å–å‡ºå¯¹åº”çš„handler Bean
    if (handler instanceof String) {
        String handlerName = (String) handler;
        handler = obtainApplicationContext().getBean(handlerName);
    }
    ...
    // æŠŠ handlerå°è£…åˆ° HandlerExecutionChainä¸­ï¼Œå¹¶æ·»åŠ ä¸Šæ‹¦æˆªå™¨
    HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request);
    ...
}

-- org.springframework.web.servlet.handler.AbstractHandlerMapping.getHandlerExecutionChain() --
æ³¨é‡Šï¼š
ä½œç”¨ï¼šä¸ºæŒ‡å®šçš„handler æ¥ åˆ›å»ºä¸€ä¸ª HandlerExecutionChainï¼ˆå…¶ä¸­åŒ…å«é€‚åˆçš„æ‹¦æˆªå™¨ï¼‰ã€‚
ç‰¹å¾ï¼š
    #1 é»˜è®¤çš„å®ç°ä¼šä½¿ç”¨ ç»™å®šçš„handler æ¥ æ„å»º {#1 ä¸€ä¸ªæ ‡å‡†çš„HandlerExecutionChain,
        #2 handlerMappingçš„å¸¸ç”¨æ‹¦æˆªå™¨, #3 ä»¥åŠèƒ½å¤ŸåŒ¹é…å½“å‰ request URLçš„ä»»æ„ MappedInterceptors}
    #2 æ‹¦æˆªå™¨ä¼šä»¥å®ƒä»¬è¢«æ³¨å†Œçš„é¡ºåºè¿›è¡Œæ·»åŠ ã€‚
    #3 å­ç±»å¯ä»¥ è¦†å†™å®ƒ æ¥ æ‰©å±•/é‡æ–°å®‰æ’ æ‹¦æˆªå™¨çš„åˆ—è¡¨ã€‚

protected HandlerExecutionChain getHandlerExecutionChain(Object handler, HttpServletRequest request) {
    HandlerExecutionChain chain = (handler instanceof HandlerExecutionChain ?
            (HandlerExecutionChain) handler : new HandlerExecutionChain(handler));

    ...

    return chain;
}


-- è·å–handler - org.springframework.web.servlet.handler.AbstractHandlerMapping.getHandlerInternal() --
æ³¨é‡Šï¼š
ä½œç”¨ï¼šä¸ºç»™å®šçš„request æ¥ æŸ¥æ‰¾ä¸€ä¸ªhandlerï¼›
ç‰¹å¾ï¼š
    #1 å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„handleråˆ™è¿”å› null
    #2 è¿™ä¸ªæ–¹æ³• è¢« getHandler()æ–¹æ³•è°ƒç”¨ï¼›
    #3 ä¸€ä¸ª nullçš„è¿”å›ç»“æœ ä¼šå¯¼è‡´é»˜è®¤çš„handlerï¼ˆå¦‚æœè®¾ç½®äº†é»˜è®¤çš„handlerçš„è¯ï¼‰

å®ç°è¿‡ç¨‹ï¼š
#1 ä»HTTPè¯·æ±‚ä¸­è·å–åˆ°URLï¼›
#2 æ ¹æ®URLåˆ° urlMappingä¸­è·å–åˆ° handlerï¼›

ä»£ç å®ç°ï¼š
    // ä»requestä¸­ è§£æåˆ°è¯·æ±‚çš„URLè·¯å¾„?
    String lookupPath = initLookupPath(request);
    Object handler;
    if (usesPathPatterns()) {
        // ä»requestä¸­ è§£æåˆ°è¯·æ±‚çš„URLè·¯å¾„?
        RequestPath path = ServletRequestPathUtils.getParsedRequestPath(request);
        // æŠŠ å¾—åˆ°çš„URLè·¯å¾„ ä¸ Handlerè¿›è¡ŒåŒ¹é…ï¼Œè¿›è€Œå¾—åˆ°å¯¹åº”çš„Handler
        // ç‰¹å¾ï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„Handlerï¼Œåˆ™ï¼šè¿”å›null - è¿™æ ·é»˜è®¤çš„Handlerå°±ä¼šè¢«ä½¿ç”¨
        handler = lookupHandler(path, lookupPath, request);
    }
    // è¿™é‡Œçš„å®ç° è·Ÿä¹¦ä¸Šè¯´å¾—ä¸ä¸€æ ·ï¼Œhandlerçš„åˆå§‹åŒ–æœ‰ä¸¤ç§æ–¹å¼ - why?
    else {
        handler = lookupHandler(lookupPath, request);
    }

    if (handler == null) {
        // è¿™é‡Œå¯¹é»˜è®¤handlerè¿›è¡Œå¤„ç†
        // æ³¨é‡Šï¼šæˆ‘ä»¬éœ€è¦ç›´æ¥å¤„ç† é»˜è®¤çš„handlerï¼Œå› ä¸ºæˆ‘ä»¬ä¹Ÿéœ€è¦ ä¸ºå®ƒæ¥æš´éœ² PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE
        Object rawHandler = null;
    }

- AbstractUrlHandlerMapping.lookupHandler(java.lang.String, javax.servlet.http.HttpServletRequest) -
ä½œç”¨ï¼šä¸ºç»™å®šçš„URL pathï¼ŒæŸ¥æ‰¾åˆ°ä¸€ä¸ª å…¶æ‰€å¯¹åº”çš„handlerå®ç°ã€‚
ç‰¹å¾ï¼šå½“ Stringæ¨¡å¼ ä¸ æ­£åœ¨ä½¿ç”¨çš„PathMatcheråŒ¹é…çš„æ—¶å€™ï¼Œå°±ä¼šä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚
ä¹¦æœ¬ï¼šlookupHandler æ ¹æ®URLè·¯å¾„ï¼Œ åœ¨handlerMapä¸­å¯åŠ¨å¯¹handlerçš„æ£€ç´¢ï¼Œå¹¶æœ€ç»ˆè¿”å›handlerå¯¹è±¡

// No handler found...
return null;

--- conclusion ---
#1 ç»è¿‡è¿™ä¸€ç³»åˆ—å¯¹HTTPè¯·æ±‚è¿›è¡Œè§£æ & åŒ¹é…handlerçš„è¿‡ç¨‹ï¼ŒSpring MVCæœ€ç»ˆå¾—åˆ°äº†ä¸è¯·æ±‚ç›¸å¯¹åº”çš„handlerå¤„ç†å™¨ã€‚
#2 åœ¨è¿”å›çš„handlerä¸­ï¼Œå·²ç»å®Œæˆäº† åœ¨HandlerExecutionChainä¸­çš„å°è£…å·¥ä½œ - ä¸ºhandler å¯¹HTTPè¯·æ±‚è¿›è¡Œå“åº” åšå¥½äº†å‡†å¤‡ï¼›

é—ç•™é—®é¢˜ï¼š
è¯·æ±‚æ˜¯æ€æ ·è¢«åˆ†å‘çš„ï¼Œå¹¶æœ€ç»ˆåˆ°è¾¾äº†å¯¹åº”çš„handlerå‘¢ï¼Ÿ
ğŸ– è¿™æ˜¯ HTTPè¯·æ±‚åœ¨MVCæ¡†æ¶ä¸­å¤„ç†è¿‡ç¨‹çš„æœ€åä¸€å—æ‹¼å›¾
