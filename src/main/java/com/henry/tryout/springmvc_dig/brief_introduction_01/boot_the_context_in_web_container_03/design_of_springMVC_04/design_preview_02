æ¦‚å¿µ & ç»„ä»¶ï¼š
#1 Spring IoCå®¹å™¨/ä¸Šä¸‹æ–‡ - WebApplicationContextï¼›
#2 IoCå®¹å™¨çš„åŠ è½½å™¨ - ContextLoaderListener
#3 Webå®¹å™¨çš„å‰ç«¯æ§åˆ¶å™¨ - DispatcherServlet

æµç¨‹ï¼š
#1 åˆå§‹åŒ– ContextLoaderListenerï¼›
#2 åˆå§‹åŒ– DispatcherServletï¼›

factï¼š
#1 DispatcherServlet ä¼šå»ºç«‹è‡ªå·±çš„ä¸Šä¸‹æ–‡ æ¥ æŒæœ‰Spring MVCçš„Beanå¯¹è±¡ã€‚
#2 åœ¨å»ºç«‹è‡ªå·±çš„æŒæœ‰çš„ä¸Šä¸‹æ–‡æ—¶ï¼Œ DSä¼šä» ServletContextä¸­ â€œè·å–åˆ°æ ¹ä¸Šä¸‹æ–‡â€ æ¥ ä½œä¸º DispatcherServletæ‰€æŒæœ‰ä¸Šä¸‹æ–‡çš„åŒäº²ä¸Šæ¬¡ä¸‹æ–‡ã€‚
#3 è·å–åˆ°#2ä¸­çš„ä¸Šä¸‹æ–‡åï¼Œæ¥ç€åœ¨å¯¹è‡ªå·±çš„ä¸Šä¸‹æ–‡è¿›è¡Œåˆå§‹åŒ–ï¼›
#4 æœ€åæŠŠè‡ªå·±æŒæœ‰çš„ä¸Šä¸‹æ–‡ä¿å­˜åˆ° ServletContextä¸­ï¼Œ ä¾›ä¹‹åæ£€ç´¢å’Œä½¿ç”¨ã€‚

--- ç”¨ä»£ç äº†è§£ DispatcherServletå¯åŠ¨çš„æ•´ä¸ªè¿‡ç¨‹ ---
-- çˆ¶ç±» FrameworkServlet --
fact: ApplicationContextçš„åˆ›å»ºè¿‡ç¨‹ ä¸ ContextLoaderåˆ›å»ºæ ¹ä¸Šä¸‹æ–‡çš„è¿‡ç¨‹ ååˆ†ç±»ä¼¼ï¼›

-- DispatcherServletç±»çš„ç»§æ‰¿å…³ç³» --
DispatcherServlet ç»§æ‰¿ HttpServletçš„è·¯å¾„ï¼š
    DispatcherServlet -> FrameworkServlet -> HttpServletBean -> HttpServlet


- HttpServlet -
æä¾›ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”¨æ¥ç»™å­ç±»ç»§æ‰¿ã€‚
ä»è€Œä½¿å¼€å‘è€…èƒ½å¤Ÿ æ¥ åˆ›å»ºä¸€ä¸ªé€‚ç”¨äºWebç«™ç‚¹çš„ HTTP servletã€‚
HttpServletçš„å­ç±» å¿…é¡»è¦è¦†ç›–è‡³å°‘ä¸€ä¸ªæ–¹æ³•, é€šå¸¸æ˜¯ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ï¼š


-- Spring MVCçš„å®ç°ï¼šä»DispatcherServlet å¼€å§‹ --
ä½œç”¨ï¼š
    #1 ä½œä¸º Spring MVCçš„å‰ç«¯å¤„ç†å™¨ï¼›
    #2 ä½œä¸º MVCæ¨¡å— ä¸ Webå®¹å™¨é›†æˆçš„å¤„ç†å‰ç«¯ã€‚
åŸç†ï¼šé€šè¿‡ä½¿ç”¨ Servlet API æ¥å¯¹HTTPè¯·æ±‚è¿›è¡Œå“åº”ã€‚
å·¥ä½œåˆ†ç±»ï¼š
    #1 åˆå§‹åŒ–éƒ¨åˆ†ï¼›
        // HttpServletBeanæ–¹æ³•çš„è¦†å†™ï¼Œä¸€æ—¦ä»»ä½•beanå±æ€§è¢«è®¾ç½®åï¼Œå½“å‰æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ã€‚
        æ¥ åˆ›å»ºè¿™ä¸ªservletçš„ WebApplicationContext.
        org.springframework.web.servlet.FrameworkServlet.initServletBean()

        æ–¹æ³•ä¾èµ–çš„è·¯å¾„ï¼ˆmethod chainï¼‰:
            this.webApplicationContext = initWebApplicationContext();
                onRefresh(wac);
                    initStrategies(context);

        -- initStrategies() --
        åˆå§‹åŒ– å½“å‰servletæ‰€ä½¿ç”¨çš„ ç­–ç•¥å¯¹è±¡é›†åˆã€‚
        ç‰¹å¾ï¼šæœ‰å¯èƒ½ä¼šåœ¨å­ç±»ä¸­è¢«é‡å†™ æ¥ åˆå§‹åŒ–æ›´å¤šçš„ç­–ç•¥å¯¹è±¡ã€‚
        ä¹¦æœ¬ï¼šåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œ DispatcherServlet å¯¹ MVCæ¨¡å—çš„å…¶ä»–éƒ¨åˆ†è¿›è¡Œäº†åˆå§‹åŒ–ï¼š
            initHandlerMappings(context);
            initViewResolvers(context);

    #2 å¯¹HTTPè¯·æ±‚è¿›è¡Œå“åº” - è¿™æ˜¯ä½œä¸ºservletçš„å·¥ä½œï¼›
        åŸç†ï¼šWebå®¹å™¨ä¼šè°ƒç”¨ Servletçš„ doGet()ä¸ doPost()æ–¹æ³•ï¼›
        ç‰¹å¾ï¼š
            #1 FrameworkServletçš„ processRequest()æ–¹æ³• ä¼šå¯¹è¯·æ±‚è¿›è¡Œç®€å•å¤„ç†ï¼›
                å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œä¸ç®¡ç»“æœå¦‚ä½•ï¼Œéƒ½ä¼šå‘å¸ƒä¸€ä¸ªäº‹ä»¶ã€‚
                äº‹ä»¶ä¼šè¢«æŠ½è±¡æ¨¡æ¿æ–¹æ³• doService() æ¥ å¤„ç†ã€‚

                - org.springframework.web.servlet.FrameworkServlet.processRequest() -
            #2 DispatcherServletä¸­çš„doService() ä¼šå¯¹è¯·æ±‚åšè¿›ä¸€æ­¥å¤„ç†ï¼›
                æš´éœ² DispatcherServletæ‰€ä¸“æœ‰çš„è¯·æ±‚å±æ€§é›†åˆï¼Œå¹¶ æŠŠè¯·æ±‚å§”æ´¾ç»™ doDispatch() æ¥ çœŸæ­£åœ°åšå§”æ´¾ï¼ˆdispatchï¼‰
                - org.springframework.web.servlet.DispatcherServlet.doService() -

                doService -> doDispatch()æ–¹æ³•

                å¤„ç†å§”æ´¾åˆ°handlerä¸Šçš„è¯·æ±‚
                é€šè¿‡æŒ‰ç…§é¡ºåº æ¥ åº”ç”¨servletçš„ HandlerMappings å°±èƒ½å¤Ÿè·å–åˆ°ï¼ˆobtainï¼‰ handlerï¼›
                é€šè¿‡æŸ¥è¯¢ servletæ‰€å®‰è£…çš„ HandlerAdapters æ¥ æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ”¯æŒ å½“å‰handlerç±»çš„ adapterï¼Œå°±èƒ½å¤Ÿè·å–åˆ° HandlerAdapterã€‚
                ä¹¦æœ¬ï¼šdoDispatch()æ–¹æ³• æ˜¯ Dispatcherå®ç°MVCæ¨¡å¼çš„ä¸»è¦éƒ¨åˆ† ğŸ‘‡
                - org.springframework.web.servlet.DispatcherServlet.doDispatch() -

