åœ¨ Servletåº”ç”¨ä¸­ï¼Œä»¥ Http Basicçš„æ–¹å¼ æ¥ æ‰§è¡Œå¯¹userçš„è®¤è¯

æ‰©å±•è‡ª SecurityFilterChainçš„å›¾è¡¨
--- ç»™æœªè®¤è¯çš„user å‘é€ä¸€ä¸ª WWW-Authenticate header ---
#1 user å‘ä¸€ä¸ªä»–æ²¡æœ‰è¢«æˆæƒçš„èµ„æº å‘é€ä¸€ä¸ªæœªè¢«è®¤è¯çš„è¯·æ±‚ï¼›
#2 Securityçš„ FilterSecurityInterceptorï¼ˆæ‹¦æˆªå™¨ï¼‰ é€šè¿‡æŠ›å‡ºä¸€ä¸ª AccessDeniedException æ¥ è¡¨ç¤º æœªè®¤è¯çš„è¯·æ±‚è¢«æ‹’ç»äº†ï¼›
#3 ç”±äº userè¿˜æ²¡æœ‰è¢«è®¤è¯ï¼Œ å› æ­¤ï¼š ExceptionTransactionFilter ä¼š å¼€å§‹è®¤è¯ï¼›
    ğŸ– è¿™é‡Œï¼Œ AuthenticationEntryPoint æ˜¯ä¸€ä¸ª BasicAuthenticationEntryPointçš„å®ä¾‹ï¼›
    ğŸ– è¿™é‡Œï¼Œ RequestCache æ˜¯ä¸€ä¸ª NullRequestCache - å®ƒä¸ä¼šå­˜å‚¨è¯·æ±‚ï¼Œå› ä¸º userèƒ½å¤Ÿé‡æ–°å‘é€ ä»–æœ€åˆå‘é€çš„è¯·æ±‚ã€‚


--- useræ¥æ”¶åˆ°äº† WWW-Authenticate headerï¼Œç„¶åä½¿ç”¨ username + password æ¥é‡è¯• ---
#1 BasicAuthentication ä¼šä» HttpServletRequestä¸­ï¼Œåˆ›å»ºå‡ºä¸€ä¸ªtokenå¯¹è±¡ï¼ˆAuthenticationå®ä¾‹ï¼‰ï¼›
#2 æŠŠ#1ä¸­çš„tokenå¯¹è±¡ä¼ é€’ç»™ AuthenticationManagerï¼›
    ğŸ– å…·ä½“ä¼šä½¿ç”¨ AuthenticationManagerçš„å®ç°ç±» å–å†³äº userä¿¡æ¯çš„å­˜å‚¨æ–¹å¼ï¼›
#3 å¦‚æœè®¤è¯å¤±è´¥ï¼Œåˆ™ï¼š {123}
#4 å¦‚æœè®¤è¯æˆåŠŸï¼Œåˆ™ï¼š{123}

===
å¤±è´¥æ—¶çš„{123}
#1 æ¸…é™¤ SecurityContextHolderï¼›
#2 è°ƒç”¨ RememberMeServices.loginFail()æ–¹æ³• - å¦‚æœæ²¡æœ‰é…ç½® remember me, åˆ™ï¼šä»€ä¹ˆéƒ½ä¸ä¼šåš
#3 è°ƒç”¨ AuthenticationEntryPoint æ¥ è§¦å‘ å†æ¬¡å‘é€ WWW-Authenticateã€‚

===
æˆåŠŸæ—¶çš„{123}
#1 æŠŠ Authentication è®¾ç½®åˆ° SecurityContextHolderä¸­å»ï¼›
#2 è°ƒç”¨ RememberMeServices.loginSuccess()æ–¹æ³•
#3 BasicAuthenticationFilterä¼šè°ƒç”¨ FilterChain.doFilter(request, response) æ¥ ç»§ç»­å‰©ä½™çš„åº”ç”¨é€»è¾‘ã€‚

===
ç”¨æ³•ï¼ˆå¼€å‘è€…ï¼‰ï¼š
Securityé»˜è®¤å¼€å¯äº† å¯¹ HTTP Basicè®¤è¯æ–¹å¼çš„æ”¯æŒã€‚
ä½†å¦‚æœå¼€å‘è€…æä¾›äº†ä»»ä½• åŸºäºservletçš„é…ç½®ï¼Œåˆ™ï¼šå¼€å‘è€…å°±å¿…é¡»è¦æ˜¾å¼é…ç½® HTTP Basicï¼›

#1 æœ€ç®€å•çš„é…ç½®ä»£ç 
@Bean
public SecurityFilterChain filterChain(HttpSecurity http) {
	http
		// ...
		.httpBasic(withDefaults());
	return http.build();
}